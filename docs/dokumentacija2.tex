\documentclass[11pt]{article}

\usepackage[utf8]{inputenc} % Required for inputting international characters
\usepackage[T1]{fontenc} % Output font encoding for international characters
\usepackage{booktabs}
\usepackage{mathpazo} % Palatino font
\pretolerance=150
\usepackage{amsmath}

\begin{document}

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\begin{titlepage} % Suppresses displaying the page number on the title page and the subsequent page counts as page 1
	
	\center % Centre everything on the page
	
	%------------------------------------------------
	%	Headings
	%------------------------------------------------
	
	\textsc{\LARGE SVEU\v{C}ILI\v{S}TE U ZAGREBU}\\[0.4cm] % Main heading such as the name of your university/college
	\textsc{\LARGE \textbf{FAKULTET ELEKTROTEHNIKE I RA\v{C}UNALSTVA}}\\[2.5cm]
    
	\textsc{\Large Projekt iz Bioinformatike}\\[0.5cm] % Major heading such as course name
	

	%------------------------------------------------
	%	Title
	%------------------------------------------------
	
	
	{\huge\bfseries Ra\v{c}unanje najduljeg zajedni\v{c}kog prefixa temeljeno na BWT}\\[1.2cm] % Title of your document
	
	
	%------------------------------------------------
	%	Author(s)
	%------------------------------------------------
	\begin{minipage}{2.5\textwidth}
		\begin{flushleft}
			\large
			\textit{Autori}\\
			 \textsc{Zvonimir Jurelinac, Tomislav Živec, Tonko Čupić} % Your name
		\end{flushleft}
	\end{minipage}
	~\\[0.2cm]
	\begin{minipage}{2.5\textwidth}
		\begin{flushleft}
			\large
			\textit{Voditelj}\\
			doc.dr.sc \textsc{Mirjana Domazet- Lo\v{s}o} % Supervisor's name
		\end{flushleft}
	\end{minipage}
	
	% If you don't want a supervisor, uncomment the two lines below and comment the code above
	%{\large\textit{Author}}\\
	%John \textsc{Smith} % Your name
	
	%------------------------------------------------
	%	Date
	%------------------------------------------------
	
	\vfill\vfill\vfill\vfill % Position the date 3/4 down the remaining page
	
	{\large Zagreb, prosinac 2017.} % Date, change the \today to a set date if you want to be precise
	
	%------------------------------------------------
	%	Logo
	%------------------------------------------------
	
	%\vfill\vfill
	%\includegraphics[width=0.2\textwidth]{placeholder.jpg}\\[1cm] % Include a department/university logo - this will require the graphicx package
	 
	%----------------------------------------------------------------------------------------
	
	
\end{titlepage}

%----------------------------------------------------------------------------------------
\newpage

\tableofcontents
\newpage

\section{Uvod}

Bioinformatika je grana znanosti koja usko povezuje biologiju i računarstvo, a ubrzano se razvijala zadnja dva desetljeća. Pojeftinjenje i sve veća dostupnost tehnologije sekvenciranja rezultirale su stvaranjem velikih skupova bioloških podataka. Često se kao zadatak u bioinformatici nameće analiza sekvence genoma.
Pošto su te sekvence predugačke za uobičajenu pohranu i analizu, potrebno je koristiti posebna sufiksna polja i polja najdužeg zajedničkog prefiksa. Cilj projekta je bio implementirati algoritme 1 i 2 iz rada Beller et al. (2013), koristeći gotovu knjižnicu za izgradnju sufiksnog polja. 
Zatim je implementacija testirana sa našom implementacijom stabla valića i njegove funkcije rang. Rješenje je uspoređeno s rezultatima iz studetskog rada Mrčela et al. (2016). Kao ulazni niz koristili smo genom bakterije E. Coli

\newpage

\section{Algoritmi}
U problemima analiza sekvenci vrlo često se javlja potreba za izračunom najduljeg zajedničkog prefiksa (LCP). U tu svrhu koriste sufiksni nizovi koji spremaju u listu spremaju sve moguće sufikse sekvence, od duljine 1 do najdulje. Iz sufiksnog niza dobiva se LCP polje u linearnom vremenu. 
Veliki resursni zahtjevi analize senkvenci DNK nameću zahtjeve za korištenjem podatkovnih struktura koje koriste manje memorijskog prostora. Iz te potrebe razvijeno je stablo valića niza transformiranog Burrows- Wheelerovom transformacijom (BWT).
Metoda je sljedeća: sekvenca se prvo podliježe Burrows- Wheelerovoj transformaciji, potom se transformirana sekvenca sprema u stablo valića. Stablo valića podržava pretraživanje unatrag po originalnom nizu pa tako dobivamo tražene sufikse. Opisani algoritam ima složenost $O(n\log\sigma)$, gdje je $\sigma$ veličina abecede.

\subsection{Podatkovne strukture}

\subsubsection{Sufiksno polje}
Sufiksno polje sadrži sve sufikse od teksta S. Zamijenila je u toj zadaći sufiksno stablo jer koristi manje memorije od sufiksnog stabla za istu zadaću. Sufiksno polje se pokazalo kao vrlo važan alat u raspoznavanju i analizi teksta, bioinformatici i drugim primjenama. 
Sufiksno polje SA od niza znakova S je cjelobrojno polje u intervalu od 1 do n koje određuje leksikografski poredak svih n sufiksa niza znakova S. Preciznije, sufiksno polje zadovoljava $ S_{SA[1]} < S_{SA[2]} < ... < S_{SA[n]}$, gdje $ S_i $ označava i-ti sufiks niza znakova S, te sadrži znakove S[i..n].
 
\subsubsection{Burrows- Wheelerova transformacija (BWT)}
\label{BWT_definicija}
Burrows- Wheelerova transformacija pretvara niz znakova u sličan niz znakova BWT[1..n] sa istom abecedom. Koristi se za kompresiju podataka. Transformacija je reverzibilna bez dodatnih resursnih zahtjeva. Elemente transformiranog niza računamo formulom:

\[
BWT[i]=\begin{cases}
S[SA[i]-1], & \text{ako } SA[i]\neq 1 & 
\$, & \text{inače}.
\end{cases}
\]
 
 
\begin{table}
	\caption{Pridruživanje indeksa sufiksima niza S, počevši od najduljeg.}
	\label{tablePrimjer1}
	\begin{center}
		\begin{tabular}{ll}
			\toprule
			i & S$_{SA}$[i] \\
			\midrule
			1 & abrakadabra\$ \\
			2 & brakadabra\$ \\
			3 & rakadabra\$ \\
			4 & akadabra\$ \\
			5 & kadabra\$ \\
			6 & adabra\$ \\
			7 & dabra\$ \\
			8 & abra\$ \\
			9 & bra\$ \\
			10 & ra\$ \\
			11 & a\$ \\
			12 & \$ \\
			\bottomrule
		\end{tabular}
	\end{center}
\end{table}

\begin{table}
	\caption{Sufiksi su poredani leksikografski, a njihovi indeksi čine sufiksno polje SA.}
	\label{tablePrimjer2}
	\begin{center}
		\begin{tabular}{rrll}
			\toprule
			i & SA[i] & S$_{SA}$[i] & BWT[i] \\
			\midrule
			1 & 12 & \$ & a\\
			2 & 11 &  a\$ & r \\
			3 & 8 & abra\$ & d \\
			4 & 1 & abrakadabras\$ & \$ \\
			5 & 6 & adabra\$ & k \\
			6 & 4 & akadabra\$ & r \\
			7 & 9 & bra\$ & a\\
			8 & 2 & brakadabra\$ & a\\
			9 & 7 & dabra\$ & a \\
			10 & 5 & kadabra\$ & a\\
			11 & 10 & ra\$ & b \\
			12 & 3 & rakadabra\$ & b\\
			\bottomrule
		\end{tabular}
		
	\end{center}
	
\end{table}

\newpage

\subsubsection{Stablo valića}

Stablo valića je struktura podataka koja rekurzivno particionira tok u 2 dijela sve dok su u svakom dijelu preostali homogeni podatci. Ime stabla je analogno valnoj transformaciji signala koji rekurzivno dekompresira signal prema frenkvencijama komponenti. 

Stablo valića može efikasno raditi upite rank i select nad nizovima proizvoljnih abeceda. To nam omogućuje pretraživanje unatrag u vremenskoj složenosti od  $O(\log\sigma)$ po koraku.
Prvo definiramo uzlazno poredanu abecedu $\Eta$kao niz znakova veličine $\sigma $.  
Zatim definiramo interval [1..r] kao podinterval abecede, r <= $\sigma$
Za interval [1..r], niz znakova BWT[1..r] dobijemo tako da iz transformiranog niza znakova od S uklonimo sve znakove iz B-W transformacije koji ne pripadaju segmentu abecede [1..r]

\section{Primjer rada algoritma}
U nastavku dokumenta dan je primjer rada algoritma na stringu S = mississippi.

\subsection{Izgradnja sufiksnog polja}
\begin{enumerate}
\item Na kraj ulaznog niza dodaje se znak \$ te je sada S =  mississippi\$. U daljnjem tekstu vrijedi pretpostavka da je znak \$ abecedno manji od svih ostalih znakova od kojih je S izrađen.
\item Svakom sufiksu niza S pridružuju se indeksi od 1 do \textit{n}, počevši od najduljeg. Ovo je prikazano u \textbf{tablici \ref{tableEx1}}

\begin{table}
\caption{Pridruživanje indeksa sufiksima niza S}
\label{tableEx1}
\begin{center}
\begin{tabular}{ll}
\toprule
i & S$_{SA}$[i] \\
\midrule
1 & mississippi\$ \\
2 & ississippi\$ \\
3 & ssissippi\$ \\
4 & sissippi\$ \\
5 & issippi\$ \\
6 & ssippi\$ \\
7 & sippi\$ \\
8 & ippi\$ \\
9 & ppi\$ \\
10 & pi\$ \\
11 & i\$ \\
12 & \$ \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

\item Sufiksno polje \(SA\) dobivamo soritiranjem dobivenih sufiksa leksikografski od najmanjeg prema najvećem. Ovo je prikazano u \textbf{tablici \ref{tableEx2}}.

Dobiveno je sufiksno polje SA = [12, 11, 8, 5, 2, 1, 10, 9, 7, 4, 6, 3]

\begin{table}
\caption{Sufiksi su poredani leksikografski, a njihovi indeksi čine sufiksno polje SA.}
\label{tablePrimjer2}
\begin{center}
\begin{tabular}{rrl}
\toprule
i & SA[i] & S$_{SA}$[i] \\
\midrule
1 & 12 & \$ \\
2 & 11 &  i\$ \\
3 & 8 & ippi\$ \\
4 & 5 & issippi\$ \\
5 & 2 & ississippi\$ \\
6 & 1 & misssissippi\$ \\
7 & 10 & pi\$ \\
8 & 9 & ppi\$ \\
9 & 7 & sippi\$ \\
10 & 4 & sissippi\$ \\
11 & 6 & ssippi\$ \\
12 & 3 & ssissippi\$ \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

\item Izračunava se Burrows-Wheelerova transformacija BWT[1..n] za dobiveno sufiksno polje SA prema formuli navedenoj u \ref{BWT_defincija} .  
\newline Npr. BWT[4]=S[SA[4]-1]=S[5-1]=S[4]=s.

Rezultat je prikazan u tablici \textbf{tablice \ref{tableEx3}}. 

\begin{table}
\caption{Burrows-Wheelerova tranformacija}
\label{tableEx3}
\begin{center}
\begin{tabular}{rrll}
\toprule
i & SA[i] & S$_{SA}$[i] & BWT[i] \\
\midrule
1 & 12 & \$ & i \\
2 & 11 &  i\$ & p \\
3 & 8 & ippi\$ & s \\
4 & 5 & issippi\$ & s \\
5 & 2 & ississippi\$ & m \\
6 & 1 & misssissippi\$ & \$ \\
7 & 10 & pi\$ & p \\
8 & 9 & ppi\$ & i \\
9 & 7 & sippi\$ & s \\
10 & 4 & sissippi\$ & s \\
11 & 6 & ssippi\$ & i \\
12 & 3 & ssissippi\$ & i \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

\end{document}